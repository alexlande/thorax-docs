
<html>
  <head>
    <meta charset="utf-8">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thorax: Form Plugin</title>
    
    <link rel="stylesheet" type="text/css" href="screen.css">
    
    

    

    <!-- Typekit -->
    
      <script type="text/javascript">
        (function() {
          var config = {
            kitId: 'hjp0pft',
            scriptTimeout: 3000
          };
          var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/( |^)wf-loading( |$)/g,"");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script");tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(a&&a!="complete"&&a!="loaded")return;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
        })();
      </script>
    
  </head>
  <body><div id="container">
  <div id="nav">
    
      <div id="header">
        <a href="index.html" id="logo">Thorax<span>Form Plugin</span></a>
      </div>
    
    <ul id="sections">
      
        <li>
          <a href="#form-handling">Form Handling</a>
          
            <ul>
              
                <li>
                  <a href="#form-handling/serialize-view-serialize-event-callback-options">serialize </a>
                </li>
              
                <li>
                  <a href="#form-handling/populate-view-populate-attributes">populate </a>
                </li>
              
                <li>
                  <a href="#form-handling/validateinput-view-validateinput-attributes">validateInput </a>
                </li>
              
            </ul>
          
        </li>
      
    </ul><div class="header"><a href="#">Plugins</a></div><ul class="sections"><li><a href="collection.html">Collection</a></li><li><a href="event.html">Event</a></li><li><a href="form.html">Form</a></li><li><a href="helpers.html">Helpers</a></li><li><a href="loading.html">Loading</a></li><li><a href="model.html">Model</a></li><li><a href="view-controller.html">ViewController</a></li></ul>
    
    
  </div>
  <div id="content">
    
    <h1>Thorax Form Plugin</h1>
<h2 id="form-handling">Form Handling</h2>
<p>Thorax provides helpers to assist with form handling, but makes no user interface decisions for you. Use the <code>validate</code> and <code>error</code> events to implement error messages in your application.

</p>
<pre><code>Application<span class="preprocessor">.View</span><span class="preprocessor">.registerEvents</span>({
  validate: function(attributes, errors) {
    //clear previous errors if present
  },
  error: function(errors) {
    errors<span class="preprocessor">.forEach</span>(function(error) {
      //lookup input by error<span class="preprocessor">.name</span>
      //display error from error<span class="preprocessor">.message</span>
    })<span class="comment">;</span>
  }
})<span class="comment">;</span></code></pre>
<h3 id="form-handling/serialize-view-serialize-event-callback-options" class="signature">serialize <em>view.serialize([event], callback [,options])</em></h3>
<p>Serializes a form. <code>callback</code> will receive the attributes from the form and will only be called if <code>validateInput</code> returns nothing or an empty array. If an <code>event</code> is passed a check will be run to prevent duplicate submission. <code>options</code> may contain:

</p>
<ul>
<li><code>set</code> - defaults to true, wether or not to set the attributes if valid on a model if one was set with <code>setModel</code></li>
<li><code>validate - defaults to true, wether or not to call </code>validateInput` during serialization</li>
</ul>
<p>Each form input in your application should contain a corresponding label. Since you may want to re-use the same form multiple times in the same view a <code>cid</code> attribute with a unique value is provided to each render call of each template:

</p>
<pre><code><span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"<span class="variable">{{cid}}</span>-last-name"</span>/</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"last-name"</span> <span class="attribute">id</span>=<span class="value">"<span class="variable">{{cid}}</span>-last-name"</span> <span class="attribute">value</span>=<span class="value">"Beastridge"</span>/</span>
<span class="tag">&lt;<span class="title">label</span> <span class="attribute">for</span>=<span class="value">"<span class="variable">{{cid}}</span>-last-name"</span>/</span>
<span class="tag">&lt;<span class="title">input</span> <span class="attribute">name</span>=<span class="value">"address[street]"</span> <span class="attribute">value</span>=<span class="value">"123 Chestnut"</span> <span class="attribute">id</span>=<span class="value">"<span class="variable">{{cid}}</span>-address[street]"</span>/</span>

new Thorax.View({
  events: {
    "submit form": "_handleSubmit"
  },
  _handleSubmit: function(event) {
    this.serialize(event, function(attributes) {
      attributes["last-name"] === "Beastridge";
      attributes.address.street === "123 Chestnut";
    });
  }
});</code></pre>
<p><code>serialize</code> Triggers the following events:

</p>
<ul>
<li><code>serialize</code> - called before validation with serialized attributes</li>
<li><code>validate</code> - with an attributes hash and errors array after <code>validateInput</code> is called</li>
<li><code>error</code> - with an errors array, if validateInput returned an array with any errors</li>
</ul>
<p>If your view uses inputs with non standard names (or no names, multiple inputs with the same name, etc), use the <code>serialize</code> event:

</p>
<pre><code><span class="keyword">this</span>.bind(<span class="string">'serialize'</span>, _.bind(<span class="keyword">function</span>(attributes) {
  attributes.custom = <span class="keyword">this</span>.$(<span class="string">'.my-input'</span>).val();
}, <span class="keyword">this</span>));</code></pre>
<h3 id="form-handling/populate-view-populate-attributes" class="signature">populate <em>view.populate([attributes])</em></h3>
<p>Populate the form fields in the view with the given attributes. The keys of the attributes should correspond to the names of the inputs. <code>populate</code> is automatically called with the response from <code>view.context(view.model.attributes)</code> when <code>setModel</code> is called.

</p>
<pre><code>view<span class="preprocessor">.populate</span>({
  <span class="string">"last-name"</span>: <span class="string">"Beastridge"</span>
  address: {
    street: <span class="string">"123 Chestnut"</span>
  }
})<span class="comment">;</span></code></pre>
<p><code>populate</code> triggers a <code>populate</code> event. If your view uses inputs with non standard names (or no names, multiple inputs with the same name, etc), use this event:

</p>
<pre><code><span class="keyword">this</span>.bind(<span class="string">'populate'</span>, _.bind(<span class="keyword">function</span>(attributes) {
  <span class="keyword">this</span>.$(<span class="string">'.my-input'</span>).val(attributes.custom);
}, <span class="keyword">this</span>));</code></pre>
<h3 id="form-handling/validateinput-view-validateinput-attributes" class="signature">validateInput <em>view.validateInput(attributes)</em></h3>
<p>Validate the attributes created by <code>serialize</code>, must return an array or nothing (if valid). It's recommended that the array contain hashes with <code>name</code> and <code>message</code> attributes, but arbitrary data or objects may be passed. If the array has a zero length the attributes are considered to be valid. Returning an array with any errors will trigger the <code>error</code> event.

</p>
<pre><code><span class="identifier">validateInput</span><span class="symbol">:</span> <span class="identifier">function</span>(<span class="identifier">attributes</span>) {
  <span class="identifier">var</span> <span class="identifier">errors</span> = [];
  <span class="identifier"><span class="keyword">if</span></span> (<span class="identifier">attributes</span>.<span class="identifier">password</span> &amp;&amp; !<span class="identifier">attributes</span>.<span class="identifier">password</span>.<span class="identifier"><span class="keymethods">match</span></span>(<span class="regexp">/.{6,11}/</span>)) {
    <span class="identifier">errors</span>.<span class="identifier"><span class="keymethods">push</span></span>({<span class="identifier"><span class="keymethods">name</span></span><span class="symbol">:</span> <span class="string">'password'</span>, <span class="identifier">message</span><span class="symbol">:</span> <span class="string">'Invalid Password'</span>});
  }
  <span class="identifier"><span class="keyword">return</span></span> <span class="identifier">errors</span>;
}</code></pre>

  <p>Copyright 2012 <a href="http://walmartlabs.com">@WalmartLabs</a></p></div>
</div><a href="https://github.com/walmartlabs/thorax"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"></a></body>
</html>